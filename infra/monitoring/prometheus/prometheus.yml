global:
  scrape_interval: 15s
  evaluation_interval: 15s

# OTLP 설정 (Prometheus 3.x)
otlp:
  keep_identifying_resource_attributes: true
  promote_resource_attributes:
    - service.instance.id
    - service.name
    - service.namespace
    - deployment.environment.name

scrape_configs:
  # Prometheus self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # Kong Gateway metrics
  - job_name: 'flash-deals/gateway'
    static_configs:
      - targets: ['gateway:8001']
    metrics_path: /metrics
    metric_relabel_configs:
      - source_labels: [__name__]
        regex: 'kong_(.*)'
        action: keep
      - target_label: service_name
        replacement: gateway
      - target_label: service_namespace
        replacement: flash-deals
